# Hunt Creek Salmon ITS 2014-2016

################################
# 1. prep metadata

#Sample List & Mapping Files

Hunt_Creek_Map_ITS_R1.txt

#SampleID	BarcodeSequence	LinkerPrimerSequence	Month	Day	YYYY	Date	Reach	Subreach	Source	Total_Biofilm_Growth	Total_Biofilm_Growth_PostCarcass	Year	Description
HC.I.1	ACGTGCGCTGCGTACG	N	June	30	2016	30-Jun-16	Control	CI	Biofilm	279	265	2	HC.I.1
HC.I.2	GATCTACGTCGACGAG	N	June	30	2016	30-Jun-16	Control	CII	Biofilm	279	265	2	HC.I.2
HC.I.3	CTCGACTTAGAGTCAC	N	June	30	2016	30-Jun-16	Control	CIII	Biofilm	279	265	2	HC.I.3
HC.I.4	ATAGTACCCGTTACTA	N	June	30	2016	30-Jun-16	Salmon	SI	Biofilm	279	265	2	HC.I.4
HC.I.5	TCTCTATGGATCGTGT	N	June	30	2016	30-Jun-16	Salmon	SII	Biofilm	279	265	2	HC.I.5
HC.I.6	GATCTACGCGTTACTA	N	June	30	2016	30-Jun-16	Salmon	SIII	Biofilm	279	265	2	HC.I.6
HC.I.7	TAGCAGCTGTCAGATA	N	March	19	2016	19-Mar-16	Salmon	SIII	Biofilm	176	162	2	HC.I.7
HC.I.8	CGAAGTATAGAGTCAC	N	March	19	2016	19-Mar-16	Salmon	SII	Biofilm	176	162	2	HC.I.8
HC.I.9	GTAACGAGGTCAGATA	N	March	19	2016	19-Mar-16	Salmon	SI	Biofilm	176	162	2	HC.I.9
HC.I.10	CTCGACTTACGTCTCG	N	March	19	2016	19-Mar-16	Control	CIII	Biofilm	176	162	2	HC.I.10
HC.I.11	GATCTACGGATCGTGT	N	March	19	2016	19-Mar-16	Control	CII	Biofilm	176	162	2	HC.I.11
HC.I.12	CTCGACTTGATCGTGT	N	March	19	2016	19-Mar-16	Control	CI	Biofilm	176	162	2	HC.I.12
HC.I.13	GTAACGAGAGAGTCAC	N	October	25	2015	25-Oct-15	Salmon	SIII	Biofilm	35	16	2	HC.I.13
HC.I.14	CGTAGCGAGTCAGATA	N	October	25	2015	25-Oct-15	Salmon	SII	Biofilm	35	16	2	HC.I.14
HC.I.15	TAGCAGCTACGTCTCG	N	October	25	2015	25-Oct-15	Salmon	SI	Biofilm	35	16	2	HC.I.15
HC.I.16	TCTCTATGTAGTGTAG	N	October	25	2015	25-Oct-15	Control	CIII	Biofilm	35	16	2	HC.I.16
HC.I.17	CTCGACTTCGTTACTA	N	October	25	2015	25-Oct-15	Control	CII	Biofilm	35	16	2	HC.I.17
HC.I.18	TAGCAGCTAGAGTCAC	N	October	25	2015	25-Oct-15	Control	CI	Biofilm	35	16	2	HC.I.18
HC.I.19	AACGCTGAACGACGTG	N	October	4	2015	4-Oct-15	Salmon	SIII	Biofilm	14	0	2	HC.I.19
HC.I.20	TCTCTATGTGCGTACG	N	October	4	2015	4-Oct-15	Salmon	SII	Biofilm	14	0	2	HC.I.20
HC.I.21	GTAACGAGCGTCGCTA	N	October	4	2015	4-Oct-15	Salmon	SI	Biofilm	14	0	2	HC.I.21
HC.I.22	TCTCTATGACGACGTG	N	October	4	2015	4-Oct-15	Control	CIII	Biofilm	14	0	2	HC.I.22
HC.I.23	GATCTACGGACACTGA	N	October	4	2015	4-Oct-15	Control	CII	Biofilm	14	0	2	HC.I.23
HC.I.24	CGAAGTATACGACGTG	N	October	4	2015	4-Oct-15	Control	CI	Biofilm	14	0	2	HC.I.24
HC.I.25	TGCTCGTAGTCAGATA	N	August	4	2015	4-Aug-15	Salmon	SIII	Biofilm	320	306	1	HC.I.25
HC.I.26	TGCTCGTAGACACTGA	N	August	4	2015	4-Aug-15	Salmon	SII	Biofilm	320	306	1	HC.I.26
HC.I.27	GATCTACGGTCAGATA	N	August	4	2015	4-Aug-15	Salmon	SI	Biofilm	320	306	1	HC.I.27
HC.I.28	AACGCTGACGTCGCTA	N	August	4	2015	4-Aug-15	Control	CIII	Biofilm	320	306	1	HC.I.28
HC.I.29	ATAGTACCTAGTGTAG	N	August	4	2015	4-Aug-15	Control	CII	Biofilm	320	306	1	HC.I.29
HC.I.30	CTCGACTTGCTCTAGT	N	August	4	2015	4-Aug-15	Control	CI	Biofilm	320	306	1	HC.I.30
HC.I.31	TAGCAGCTGACACTGA	N	May	12	2015	12-May-15	Salmon	SIII	Biofilm	236	222	1	HC.I.31
HC.I.32	GCGTATACCTAGAGCT	N	May	12	2015	12-May-15	Salmon	SII	Biofilm	236	222	1	HC.I.32
HC.I.33	GATCTACGTGCGTACG	N	May	12	2015	12-May-15	Salmon	SI	Biofilm	236	222	1	HC.I.33
HC.I.34	ACGTGCGCAGAGTCAC	N	May	12	2015	12-May-15	Control	CIII	Biofilm	236	222	1	HC.I.34
HC.I.35	AACGCTGAACGTCTCG	N	May	12	2015	12-May-15	Control	CII	Biofilm	236	222	1	HC.I.35
HC.I.36	TCTCTATGGACACTGA	N	May	12	2015	12-May-15	Control	CI	Biofilm	236	222	1	HC.I.36

#Sequence Reads

HCBF1_ITS_28_B01_S13_L001_R1_001.fastq
HCBF1_ITS_28_B01_S13_L001_R2_001.fastq

HCBF1_ITS_28_B05_S17_L001_R1_001.fastq
HCBF1_ITS_28_B05_S17_L001_R2_001.fastq

HCBF1_ITS_28_B08_S20_L001_R1_001.fastq
HCBF1_ITS_28_B08_S20_L001_R2_001.fastq

HCBF1_ITS_28_C01_S25_L001_R1_001.fastq
HCBF1_ITS_28_C01_S25_L001_R2_001.fastq

HCBF1_ITS_28_C02_S26_L001_R1_001.fastq
HCBF1_ITS_28_C02_S26_L001_R2_001.fastq

HCBF1_ITS_28_C03_S27_L001_R1_001.fastq
HCBF1_ITS_28_C03_S27_L001_R2_001.fastq

HCBF1_ITS_28_C06_S30_L001_R1_001.fastq
HCBF1_ITS_28_C06_S30_L001_R2_001.fastq

HCBF1_ITS_28_C07_S31_L001_R1_001.fastq
HCBF1_ITS_28_C07_S31_L001_R2_001.fastq

HCBF1_ITS_28_E01_S49_L001_R1_001.fastq
HCBF1_ITS_28_E01_S49_L001_R2_001.fastq

HCBF1_ITS_28_E03_S51_L001_R1_001.fastq
HCBF1_ITS_28_E03_S51_L001_R2_001.fastq

HCBF1_ITS_28_E11_S59_L001_R1_001.fastq
HCBF1_ITS_28_E11_S59_L001_R2_001.fastq

HCBF1_ITS_28_F05_S65_L001_R1_001.fastq
HCBF1_ITS_28_F05_S65_L001_R2_001.fastq

HCBF1_ITS_28_G01_S73_L001_R1_001.fastq
HCBF1_ITS_28_G01_S73_L001_R2_001.fastq

HCBF1_ITS_28_G04_S76_L001_R1_001.fastq
HCBF1_ITS_28_G04_S76_L001_R2_001.fastq

HCBF1_ITS_28_G05_S77_L001_R1_001.fastq
HCBF1_ITS_28_G05_S77_L001_R2_001.fastq

HCBF1_ITS_28_H03_S87_L001_R1_001.fastq
HCBF1_ITS_28_H03_S87_L001_R2_001.fastq

HCBF1_ITS_28_H05_S89_L001_R1_001.fastq
HCBF1_ITS_28_H05_S89_L001_R2_001.fastq

HCBF1_ITS_28_H06_S90_L001_R1_001.fastq
HCBF1_ITS_28_H06_S90_L001_R2_001.fastq

HCBF1_ITS_28_H10_S94_L001_R1_001.fastq
HCBF1_ITS_28_H10_S94_L001_R2_001.fastq

HCBF1_ITS_28_H12_S96_L001_R1_001.fastq
HCBF1_ITS_28_H12_S96_L001_R2_001.fastq

HCBF1_ITS_29_A02_S98_L001_R1_001.fastq
HCBF1_ITS_29_A02_S98_L001_R2_001.fastq

HCBF1_ITS_29_A04_S100_L001_R1_001.fastq
HCBF1_ITS_29_A04_S100_L001_R2_001.fastq

HCBF1_ITS_29_A11_S107_L001_R1_001.fastq
HCBF1_ITS_29_A11_S107_L001_R2_001.fastq

HCBF1_ITS_29_C06_S126_L001_R1_001.fastq
HCBF1_ITS_29_C06_S126_L001_R2_001.fastq

HCBF1_ITS_29_C11_S131_L001_R1_001.fastq
HCBF1_ITS_29_C11_S131_L001_R2_001.fastq

HCBF1_ITS_29_D09_S141_L001_R1_001.fastq
HCBF1_ITS_29_D09_S141_L001_R2_001.fastq

HCBF1_ITS_29_E01_S145_L001_R1_001.fastq
HCBF1_ITS_29_E01_S145_L001_R2_001.fastq

HCBF1_ITS_29_F03_S158_L001_R1_001.fastq
HCBF1_ITS_29_F03_S158_L001_R2_001.fastq

HCBF1_ITS_29_F04_S159_L001_R1_001.fastq
HCBF1_ITS_29_F04_S159_L001_R2_001.fastq

HCBF1_ITS_29_F05_S160_L001_R1_001.fastq
HCBF1_ITS_29_F05_S160_L001_R2_001.fastq

HCBF1_ITS_29_F10_S165_L001_R1_001.fastq
HCBF1_ITS_29_F10_S165_L001_R2_001.fastq

HCBF1_ITS_29_G04_S170_L001_R1_001.fastq
HCBF1_ITS_29_G04_S170_L001_R2_001.fastq

HCBF1_ITS_29_G05_S171_L001_R1_001.fastq
HCBF1_ITS_29_G05_S171_L001_R2_001.fastq

HCBF1_ITS_29_G07_S173_L001_R1_001.fastq
HCBF1_ITS_29_G07_S173_L001_R2_001.fastq

HCBF1_ITS_29_H04_S181_L001_R1_001.fastq
HCBF1_ITS_29_H04_S181_L001_R2_001.fastq

HCBF1_ITS_29_H08_S185_L001_R1_001.fastq
HCBF1_ITS_29_H08_S185_L001_R1_001.fastq

#join paired ends

cd to folder on desktop

join_paired_ends.py -f HCBF1_ITS_28_B01_S13_L001_R1_001.fastq -r HCBF1_ITS_28_B01_S13_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_1
join_paired_ends.py -f HCBF1_ITS_28_B05_S17_L001_R1_001.fastq -r HCBF1_ITS_28_B05_S17_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_2
join_paired_ends.py -f HCBF1_ITS_28_B08_S20_L001_R1_001.fastq -r HCBF1_ITS_28_B08_S20_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_3
join_paired_ends.py -f HCBF1_ITS_28_C01_S25_L001_R1_001.fastq -r HCBF1_ITS_28_C01_S25_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_4
join_paired_ends.py -f HCBF1_ITS_28_C02_S26_L001_R1_001.fastq -r HCBF1_ITS_28_C02_S26_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_5
join_paired_ends.py -f HCBF1_ITS_28_C03_S27_L001_R1_001.fastq -r HCBF1_ITS_28_C03_S27_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_6
join_paired_ends.py -f HCBF1_ITS_28_C06_S30_L001_R1_001.fastq -r HCBF1_ITS_28_C06_S30_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_7
join_paired_ends.py -f HCBF1_ITS_28_C07_S31_L001_R1_001.fastq -r HCBF1_ITS_28_C07_S31_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_8
join_paired_ends.py -f HCBF1_ITS_28_E01_S49_L001_R1_001.fastq -r HCBF1_ITS_28_E01_S49_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_9
join_paired_ends.py -f HCBF1_ITS_28_E03_S51_L001_R1_001.fastq -r HCBF1_ITS_28_E03_S51_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_10
join_paired_ends.py -f HCBF1_ITS_28_E11_S59_L001_R1_001.fastq -r HCBF1_ITS_28_E11_S59_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_11
join_paired_ends.py -f HCBF1_ITS_28_F05_S65_L001_R1_001.fastq -r HCBF1_ITS_28_F05_S65_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_12
join_paired_ends.py -f HCBF1_ITS_28_G01_S73_L001_R1_001.fastq -r HCBF1_ITS_28_G01_S73_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_13
join_paired_ends.py -f HCBF1_ITS_28_G04_S76_L001_R1_001.fastq -r HCBF1_ITS_28_G04_S76_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_14
join_paired_ends.py -f HCBF1_ITS_28_G05_S77_L001_R1_001.fastq -r HCBF1_ITS_28_G05_S77_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_15
join_paired_ends.py -f HCBF1_ITS_28_H03_S87_L001_R1_001.fastq -r HCBF1_ITS_28_H03_S87_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_16
join_paired_ends.py -f HCBF1_ITS_28_H05_S89_L001_R1_001.fastq -r HCBF1_ITS_28_H05_S89_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_17
join_paired_ends.py -f HCBF1_ITS_28_H06_S90_L001_R1_001.fastq -r HCBF1_ITS_28_H06_S90_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_18
join_paired_ends.py -f HCBF1_ITS_28_H10_S94_L001_R1_001.fastq -r HCBF1_ITS_28_H10_S94_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_19
join_paired_ends.py -f HCBF1_ITS_28_H12_S96_L001_R1_001.fastq -r HCBF1_ITS_28_H12_S96_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_20
join_paired_ends.py -f HCBF1_ITS_29_A02_S98_L001_R1_001.fastq -r HCBF1_ITS_29_A02_S98_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_21
join_paired_ends.py -f HCBF1_ITS_29_A04_S100_L001_R1_001.fastq -r HCBF1_ITS_29_A04_S100_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_22
join_paired_ends.py -f HCBF1_ITS_29_A11_S107_L001_R1_001.fastq -r HCBF1_ITS_29_A11_S107_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_23
join_paired_ends.py -f HCBF1_ITS_29_C06_S126_L001_R1_001.fastq -r HCBF1_ITS_29_C06_S126_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_24
join_paired_ends.py -f HCBF1_ITS_29_C11_S131_L001_R1_001.fastq -r HCBF1_ITS_29_C11_S131_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_25
join_paired_ends.py -f HCBF1_ITS_29_D09_S141_L001_R1_001.fastq -r HCBF1_ITS_29_D09_S141_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_26
join_paired_ends.py -f HCBF1_ITS_29_E01_S145_L001_R1_001.fastq -r HCBF1_ITS_29_E01_S145_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_27
join_paired_ends.py -f HCBF1_ITS_29_F03_S158_L001_R1_001.fastq -r HCBF1_ITS_29_F03_S158_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_28
join_paired_ends.py -f HCBF1_ITS_29_F04_S159_L001_R1_001.fastq -r HCBF1_ITS_29_F04_S159_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_29
join_paired_ends.py -f HCBF1_ITS_29_F05_S160_L001_R1_001.fastq -r HCBF1_ITS_29_F05_S160_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_30
join_paired_ends.py -f HCBF1_ITS_29_F10_S165_L001_R1_001.fastq -r HCBF1_ITS_29_F10_S165_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_31
join_paired_ends.py -f HCBF1_ITS_29_G04_S170_L001_R1_001.fastq -r HCBF1_ITS_29_G04_S170_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_32
join_paired_ends.py -f HCBF1_ITS_29_G05_S171_L001_R1_001.fastq -r HCBF1_ITS_29_G05_S171_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_33
join_paired_ends.py -f HCBF1_ITS_29_G07_S173_L001_R1_001.fastq -r HCBF1_ITS_29_G07_S173_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_34
join_paired_ends.py -f HCBF1_ITS_29_H04_S181_L001_R1_001.fastq -r HCBF1_ITS_29_H04_S181_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_35
join_paired_ends.py -f HCBF1_ITS_29_H08_S185_L001_R1_001.fastq -r HCBF1_ITS_29_H08_S185_L001_R2_001.fastq -m SeqPrep -o HC_fastq-join_joined/HC_I_36

################################
validate mapping file

cd ~/Desktop/

validate_mapping_file.py -m Hunt_Creek_Map_ITS_R1.txt -o check.tab_mapping

#### Demultiplexing and quality filtering (at Phred >= Q20) - use the *.join.fastq file after re-naming the file and moving those files to the desktop folder named "Joined", then cd ~/Desktop/Joined

cd ~/Desktop/Joined/

# split_libraries_fastq.py -i HC.txt -o /map/ -m map_HC.txt

split_libraries_fastq.py -i HC_I_1.gz --sample_id HC.I.1 -o ~/Desktop/Demultiplexed/HC/HC_I_1_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_2.gz --sample_id HC.I.2 -o ~/Desktop/Demultiplexed/HC/HC_I_2_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_3.gz --sample_id HC.I.3 -o ~/Desktop/Demultiplexed/HC/HC_I_3_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_4.gz --sample_id HC.I.4 -o ~/Desktop/Demultiplexed/HC/HC_I_4_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_5.gz --sample_id HC.I.5 -o ~/Desktop/Demultiplexed/HC/HC_I_5_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_6.gz --sample_id HC.I.6 -o ~/Desktop/Demultiplexed/HC/HC_I_6_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_7.gz --sample_id HC.I.7 -o ~/Desktop/Demultiplexed/HC/HC_I_7_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_8.gz --sample_id HC.I.8 -o ~/Desktop/Demultiplexed/HC/HC_I_8_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_9.gz --sample_id HC.I.9 -o ~/Desktop/Demultiplexed/HC/HC_I_9_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_10.gz --sample_id HC.I.10 -o ~/Desktop/Demultiplexed/HC/HC_I_10_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_11.gz --sample_id HC.I.11 -o ~/Desktop/Demultiplexed/HC/HC_I_11_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_12.gz --sample_id HC.I.12 -o ~/Desktop/Demultiplexed/HC/HC_I_12_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_13.gz --sample_id HC.I.13 -o ~/Desktop/Demultiplexed/HC/HC_I_13_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_14.gz --sample_id HC.I.14 -o ~/Desktop/Demultiplexed/HC/HC_I_14_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_15.gz --sample_id HC.I.15 -o ~/Desktop/Demultiplexed/HC/HC_I_15_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_16.gz --sample_id HC.I.16 -o ~/Desktop/Demultiplexed/HC/HC_I_16_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_17.gz --sample_id HC.I.17 -o ~/Desktop/Demultiplexed/HC/HC_I_17_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_18.gz --sample_id HC.I.18 -o ~/Desktop/Demultiplexed/HC/HC_I_18_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_19.gz --sample_id HC.I.19 -o ~/Desktop/Demultiplexed/HC/HC_I_19_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_20.gz --sample_id HC.I.20 -o ~/Desktop/Demultiplexed/HC/HC_I_20_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_21.gz --sample_id HC.I.21 -o ~/Desktop/Demultiplexed/HC/HC_I_21_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_22.gz --sample_id HC.I.22 -o ~/Desktop/Demultiplexed/HC/HC_I_22_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_23.gz --sample_id HC.I.23 -o ~/Desktop/Demultiplexed/HC/HC_I_23_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_24.gz --sample_id HC.I.24 -o ~/Desktop/Demultiplexed/HC/HC_I_24_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_25.gz --sample_id HC.I.25 -o ~/Desktop/Demultiplexed/HC/HC_I_25_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_26.gz --sample_id HC.I.26 -o ~/Desktop/Demultiplexed/HC/HC_I_26_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_27.gz --sample_id HC.I.27 -o ~/Desktop/Demultiplexed/HC/HC_I_27_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_28.gz --sample_id HC.I.28 -o ~/Desktop/Demultiplexed/HC/HC_I_28_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_29.gz --sample_id HC.I.29 -o ~/Desktop/Demultiplexed/HC/HC_I_29_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_30.gz --sample_id HC.I.30 -o ~/Desktop/Demultiplexed/HC/HC_I_30_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_31.gz --sample_id HC.I.31 -o ~/Desktop/Demultiplexed/HC/HC_I_31_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_32.gz --sample_id HC.I.32 -o ~/Desktop/Demultiplexed/HC/HC_I_32_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_33.gz --sample_id HC.I.33 -o ~/Desktop/Demultiplexed/HC/HC_I_33_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_34.gz --sample_id HC.I.34 -o ~/Desktop/Demultiplexed/HC/HC_I_34_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_35.gz --sample_id HC.I.35 -o ~/Desktop/Demultiplexed/HC/HC_I_35_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'
split_libraries_fastq.py -i HC_I_36.gz --sample_id HC.I.36 -o ~/Desktop/Demultiplexed/HC/HC_I_36_q20 -m ~/Desktop/Joined/Hunt_Creek_Map_ITS_R1.txt -q 19 --barcode_type 'not-barcoded'

# 4(a). Concatenate the re-demultiplexed Illumina data  (check file size once this is completed)

cd ~/Desktop/Demultiplexed/

cat HC_I_1_seqs.fna HC_I_2_seqs.fna HC_I_3_seqs.fna HC_I_4_seqs.fna HC_I_5_seqs.fna HC_I_6_seqs.fna HC_I_7_seqs.fna HC_I_8_seqs.fna HC_I_9_seqs.fna HC_I_10_seqs.fna HC_I_11_seqs.fna HC_I_12_seqs.fna HC_I_13_seqs.fna HC_I_14_seqs.fna HC_I_15_seqs.fna HC_I_16_seqs.fna HC_I_17_seqs.fna HC_I_18_seqs.fna HC_I_19_seqs.fna HC_I_20_seqs.fna HC_I_21_seqs.fna HC_I_21_seqs.fna HC_I_22_seqs.fna HC_I_23_seqs.fna HC_I_24_seqs.fna HC_I_25_seqs.fna HC_I_26_seqs.fna HC_I_27_seqs.fna HC_I_28_seqs.fna HC_I_29_seqs.fna HC_I_30_seqs.fna HC_I_31_seqs.fna HC_I_32_seqs.fna HC_I_33_seqs.fna HC_I_34_seqs.fna HC_I_35_seqs.fna HC_I_36_seqs.fna > HC_ITS_R1.fna

cat HC_ITS_R1.fna > HC_ITS.fna

# validate demultiplexed concatenated file to make sure it's good for downstream analysis. Move mapping file to ~/Desktop/Demultiplexed

validate_demultiplexed_fasta.py -m Hunt_Creek_ITS_Map.txt -i HC_ITS.fna

################################

pick_open_reference_otus.py -i HC_ITS.fna -r /macqiime/sh_qiime_release_s_20/sh_refs_qiime_ver7_97_s_20.11.2016.fasta -o otus_HC_ITS/

################################
# 7. assigning taxonomy

# 7 (a) - i rep_set.fna (from 5b) -r greengenes_otu_97.fasta -t -r greengenes_otu_97_taxonomy.txt - c cutoff value

assign_taxonomy.py -i rep_set_HC_ITS.fna -r /macqiime/anaconda/lib/python2.7/site-packages/qiime_default_reference/gg_13_8_otus/rep_set/97_otus.fasta -t /macqiime/anaconda/lib/python2.7/site-packages/qiime_default_reference/gg_13_8_otus/taxonomy/97_otu_taxonomy.txt -o gg_taxonomy_HC_ITS/

#  7 (b) generating OTU table
# Using the OTU map (5a), the taxonomic assignments (7) and the list of chimeric OTUs to remove (6) to assemble a readable matrix of OTU abundance in each sample with taxonomic identifiers for each OTU.

make_otu_table.py -i HC_otus_ITS.txt -t rep_set_HC_ITS_tax_assignments.txt -o otu_table_HC_ITS_nc.biom -e rep_set_HC_ITS_failures.fasta -e HC_ITS_chimeras.txt

# 7 (b) remove singletons

filter_otus_from_otu_table.py -i otu_table_HC_ITS_nc.biom -o otu_table_HC_ITS_nc_ns.biom -n 2

# to add metadata to biom file 

biom add-metadata -i otu_table_HC_ITS_nc_ns.biom -o otu_table_HC_ITS_nc_ns_meta.biom --sample-metadata-fp Hunt_Creek_ITS_Map.txt

# 7 (c) summary of taxonomy (biom)

biom summarize-table -i otu_table_HC_ITS_nc_ns_meta.biom  -o otu_table_summary_HC_ITS.txt

# 7 (d) convert biom table to txt
#-i from 7(b)

biom convert -i otu_table_HC_ITS_nc_ns_meta.biom -o HC_ITS_table_tabseparated.txt --to-tsv --header-key="taxonomy" --output-metadata-id="Consensus Lineage"

#delete "#" to make r compatible

# 7 (e) summarize taxa tables (relative abundance)

summarize_taxa.py -i otu_table_HC_ITS_nc_ns_meta.biom -o taxonomy_summaries_HC_ITS_RA/

# 7 (f) summarize taxa tables (absolute counts)

summarize_taxa.py -i otu_table_HC_ITS_nc_ns_meta.biom -a -o taxonomy_summaries_HC_ITS_counts/

#output is a folder with .txt files of each different taxonomic level L2 (phyla); L3 (class); L4 (order); L5 (family); L6 (genus)

################################
# calculate  alpha diversity

alpha_diversity.py -i otu_table_HC_ITS_nc_ns_meta.biom -m chao1,simpson,shannon,observed_species,heip_e,simpson_e -o alpha_div_HC_ITS.txt

###################
#Make phylogenetic tree

make_phylogeny.py -i rep_set_HC_ITS_aligned.fasta -o HC_ITS_phylo.tre

#alpha and beta diversity based on phylogeny

alpha_diversity.py -i otu_table_HC_ITS_nc_ns_meta.biom -m PD_whole_tree -o adiv_HC_ITS.txt -t HC_ITS_phylo.tre

beta_diversity.py -i otu_table_HC_ITS_nc_ns_meta.biom -m weighted_unifrac -o HC_ITS_beta_div/ -t HC_ITS_phylo.tre

#Makek PcOA plots in emperor

principal_coordinates.py -i weighted_unifrac_otu_table_HC_ITS.txt -o HC_ITS_beta_div_coords.txt

make_emperor.py -i HC_ITS_beta_div_coords.txt -m Hunt_Creek_ITS_Map.txt -b "Date,Reach,Source,Total_Biofilm_Growth,Total_Biofilm_Growth_PostCarcass,Year" -o HC_ITS_PCoA

##################
#Make stacked bargraphs

summarize_taxa_through_plots.py -o taxa_summary_by_treatment -i otu_table_HC_ITS_nc_ns_meta.biom -m Hunt_Creek_ITS_Map.txt -c Reach -s
summarize_taxa_through_plots.py -o taxa_summary_by_year -i otu_table_HC_ITS_nc_ns_meta.biom -m Hunt_Creek_ITS_Map.txt -c Year -s
summarize_taxa_through_plots.py -o taxa_summary_by_source -i otu_table_HC_ITS_nc_ns_meta.biom -m Hunt_Creek_ITS_Map.txt -c Source -s

########################
#Make network files for cytoscape

make_otu_network.py -i otu_table_HC_ITS_nc.biom -m Hunt_Creek_ITS_Map.txt -o otu_HC_ITS_network
